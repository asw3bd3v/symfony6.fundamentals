# Parameters

Мы знаем, что существует концепция контейнера, в котором хранятся все наши службы... и мы можем увидеть полный список служб, выполнив:

```
php bin/console debug:container
```

## Listing Parameters

Ну, оказывается, что в контейнере есть еще одна вещь: обиды. Серьезно, не ждите, что вам удастся подшутить над сервисным контейнером и вам это сойдет с рук.

Хорошо, на самом деле, помимо служб, он содержит параметры. Это простые значения конфигурации, и мы можем увидеть их, выполнив похожую команду:

```
php bin/console debug:container --parameters
```

Это в основном переменные, которые вы можете читать и ссылаться на них в своем коде. На самом деле нам не нужно беспокоиться о большинстве из них. Они устанавливаются внутренними вещами и используются внутренними вещами. Но есть несколько, которые начинаются с kernel, что довольно интересно, например kernel.project_dir, который указывает на каталог нашего проекта. Да! Если вам когда-нибудь понадобится способ сослаться на каталог вашего приложения, этот параметр может помочь.

## Извлечение параметров из контроллера

Итак... как нам использовать эти параметры? Есть два способа. Во-первых, это не очень распространено, но вы можете получить параметр в вашем контроллере. Например, в VinylController, давайте dd($this->getParameter()) - что является сокращенным методом из AbstractController - а затем kernel.project_dir. Мы даже получаем приятное автодополнение благодаря плагину Symfony PhpStorm!

src/Controller/VinylController.php

```php
class VinylController extends AbstractController
{
// ... lines 13 - 31
    public function browse(MixRepository $mixRepository, string $slug = null): Response
    {
        dd($this->getParameter('kernel.project_dir'));
// ... lines 35 - 42
    }
}
```

И когда мы попробуем... да! Вот оно!

## Ссылка на параметры с помощью %parameter%

Теперь... удалите это. Это работает, но в большинстве случаев вы будете использовать параметры, ссылаясь на них в своих файлах конфигурации. И мы уже видели это раньше! Откройте config/packages/twig.yaml:

```yaml
twig:
    default_path: "%kernel.project_dir%/templates"
```

Помните default_path? Это ссылка на параметр kernel.project_dir. Когда вы находитесь в любом из этих конфигурационных файлов .yaml и хотите сослаться на параметр, вы можете использовать этот специальный синтаксис: %, имя параметра, затем еще %.

## Создание нового параметра

Откройте cache.yaml. Мы устанавливаем cache.adapter на filesystem для всех сред. Затем мы переопределяем его, чтобы он был адаптером массива только в среде dev. Давайте посмотрим, сможем ли мы сократить это, создав новый параметр.

Как нам создать параметры? В любом из этих файлов добавьте корневой ключ с именем параметры. Ниже вы можете просто... придумать имя. Я назову его cache_adapter и задам ему наше значение: cache.adapter.filesystem:

```yaml
parameters:
    cache_adapter: "cache.adapter.filesystem"

framework:
    cache:
```

Если у вас есть корневой ключ framework, Symfony передаст всю конфигурацию FrameworkBundle. То же самое касается ключа twig и TwigBundle.

Но параметры особенные: все, что находится ниже, создаст параметр.

Итак... теперь у нас есть новый параметр cache.adapter... который мы пока не используем. Но мы его уже видим! Запускаем:

```
php bin/console debug:container --parameters
```

Ближе к верху... вот он - cache_adapter! Чтобы использовать его, здесь внизу для app, напишите %cache_adapter%:

config/packages/cache.yaml

```yaml
parameters:
    cache_adapter: 'cache.adapter.filesystem'
// ... line 3
framework:
    cache:
// ... lines 6 - 13
        app: '%cache_adapter%'
// ... lines 15 - 28
```

Вот и все. Краткое примечание: вы могли заметить, что иногда я использую кавычки в YAML, а иногда нет. В основном, в YAML вам не нужно использовать кавычки... но вы всегда можете. И если вы когда-либо не уверены, нужны они или нет, лучше перестраховаться и использовать их.

Параметры на самом деле являются одним из примеров, где требуются кавычки. Если бы мы не окружили это кавычками, это выглядело бы как особый синтаксис YAML и выдавало бы ошибку.

В любом случае, в среде разработки, вместо того, чтобы говорить framework, cache и app, все, что нам нужно сделать, это переопределить этот параметр. Я скажу параметры, затем cache_adapter... и установим его в cache.adapter.array:

```yaml
parameters:
    cache_adapter: 'cache.adapter.filesystem'
// ... line 3
framework:
    cache:
// ... lines 6 - 13
        app: '%cache_adapter%'
// ... lines 15 - 23
when@dev:
    parameters:
        cache_adapter: 'cache.adapter.array'
```

Чтобы проверить, работает ли это, перейдите сюда и выполните другую вспомогательную команду:

```
php bin/console debug:config framework cache
```

Помните, debug:config покажет вам, какая у вас текущая конфигурация под ключом framework, а затем подключом cache. И вы можете увидеть здесь, что app установлен на cache.adapter.array — разрешенное значение параметра.

Давайте проверим значение в среде prod... просто чтобы убедиться, что оно там тоже есть. Когда вы запускаете любую команду bin/console, эта команда будет выполнена в той же среде, в которой запущено ваше приложение. Поэтому, когда мы запустили debug:config, это запустилось в среде dev.

Чтобы запустить команду в среде prod, мы могли бы перейти сюда и временно изменить APP_ENV на prod... но есть более простой способ. Вы можете переопределить среду при запуске любой команды, добавив флаг в конце. Например:

```
php bin/console debug:config framework cache --env=prod
```

Но прежде чем мы попробуем это, нам всегда нужно сначала очистить кэш, чтобы увидеть изменения в среде prod. Сделайте это, запустив:

```
php bin/console cache:clear --env=prod
```

Теперь попробуйте:

```
php bin/console debug:config framework cache --env=prod
```

И... прекрасно! Он показывает cache.adapter.filesystem. Итак, контейнер также содержит параметры. Это не очень важная концепция в Symfony, так что, если вы понимаете, как они работают, все в порядке.

Хорошо, давайте вернемся к внедрению зависимостей. Мы знаем, что можем автоматически подключать службы в конструктор службы или в методы контроллера. Но что, если нам нужно передать что-то, что не является автоматически подключаемым? Например, что, если мы хотим передать один из этих параметров службе? Давайте выясним, как это работает дальше.